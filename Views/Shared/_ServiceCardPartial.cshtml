@model LocalScout.ViewModels.ServiceCardViewModel
@using LocalScout.Services
@inject ITimeZoneConverterService TimeZoneService

<div class="col">
    <div class="service-card h-100">

        <a asp-controller="Home" asp-action="ServiceDetails" asp-route-id="@Model.ServiceId">
            <div class="service-card-img-container">
                <img src="@(Model.PrimaryImageUrl ?? "https://placehold.co/600x400/eee/ccc?text=No+Image")"
                     class="service-card-img" alt="@Model.ServiceName">
            </div>
        </a>

        <div class="service-card-body">
            <div>
                <h5 class="service-card-title">
                     <a asp-controller="Home" asp-action="ServiceDetails" asp-route-id="@Model.ServiceId" class="text-decoration-none text-dark">
                        @Model.ServiceName
                     </a>
                </h5>


                @* --- LINK #3: THE PROVIDER PROFILE LINK (NOW WRAPS THE LIST) --- *@
                <a asp-controller="ServiceProvider" asp-action="Index" asp-route-id="@Model.ProviderId" class="text-decoration-none text-dark provider-details-link">
                    
                    <div class="service-card-provider">
                        <img src="@(Model.ProviderProfilePictureUrl ?? "https://placehold.co/40x40/eee/ccc?text=P")"
                             class="service-card-provider-img" alt="@Model.ProviderBusinessName">
                        <span>@Model.ProviderBusinessName</span>
                    </div>
                </a> @* --- ANCHOR TAG NOW CLOSES HERE --- *@

                <a asp-controller="Home" asp-action="ServiceDetails" asp-route-id="@Model.ServiceId" class="text-decoration-none text-dark provider-details-link">
                    @* This list is now INSIDE the <a> tag, making it clickable *@
                    <ul class="list-unstyled text-muted small mt-3">
                        <li class="mb-2"><i class="fa-solid fa-calendar-check me-2"></i>Joined
                            @TimeZoneService.ConvertToLocalTime(Model.JoinedDate.UtcDateTime).ToString("MMM dd, yyyy")</li>
                        <li class="mb-2"><i class="fa-solid fa-location-dot me-2"></i>@Model.Location</li>
                        <li class="mb-2"><i class="fa-solid fa-clock me-2"></i>@Model.BusinessHours</li>
                    </ul>     
                </a>           
            </div>

            <div class="service-card-footer">
                <div class="service-card-price">
                    @if (Model.IsNegotiable)
                    {
                        <span class="fw-bold">Negotiable</span>
                    }
                    else
                    {
                        <span>TK @Model.Price</span> <span class="unit">/ @Model.PricingUnit</span>
                    }
                </div>
                <a asp-controller="Booking" asp-action="Create" asp-route-serviceId="@Model.ServiceId" class="btn btn-booking">Book Now</a>
            </div>
        </div>
    </div>
</div>